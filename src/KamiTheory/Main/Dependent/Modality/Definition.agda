
module KamiTheory.Main.Dependent.Modality.Definition where

open import Agora.Conventions


------------------------------------------------------------------------
-- The new modality system

---------------------------------------------
-- modes

-- modes are "copies" of MLTT inside our type theory
data Mode : Set where
  â–² : Mode -- the local mode
  â—¯ : Mode -- the global mode


---------------------------------------------
-- modalities

-- modalities are morphisms between modes,
-- they are generated by the following two
-- base mode homs.
data BaseModeHom P : (m n : Mode) -> Set where
  `ï¼ ` : âˆ€(U : P) -> BaseModeHom P â–² â—¯
  `[]` : BaseModeHom P â—¯ â–²

-- in general, modalities are concatenations
-- of base modalities
data ModeHom P : (m n : Mode) -> Set where
  id : âˆ€{m} -> ModeHom P m m
  _â¨¾_ : âˆ€{m n o} -> BaseModeHom P m n  -> ModeHom P n o -> ModeHom P m o

infixr 80 _â¨¾_

record Modality P : Set where
  constructor _â†_âˆ‹_
  field dom : Mode
  field cod : Mode
  field hom : ModeHom P dom cod

infixl 40 _â†_âˆ‹_

open Modality public

_â—†_ : âˆ€{P m n k} -> ModeHom P m n -> ModeHom P n k -> ModeHom P m k
id â—† q = q
(x â¨¾ p) â—† q = x â¨¾ (p â—† q)


---------------------------------------------
-- mode transformations

open import Agora.Order.Preorder
open import Agora.Order.Lattice

module _ {P : ğ’° _} {{_ : Preorder (â„“â‚€ , â„“â‚€ , â„“â‚€) on P }} where

  private variable
    U V : P

  data BaseModeTrans : {m n : Mode} (Î¼s Î·s : ModeHom P m n) -> Set where
    narrow : U â‰¤ V -> BaseModeTrans (`ï¼ ` U â¨¾ id) (`ï¼ ` V â¨¾ id)

  data ModeTrans : {m n : Mode} (Î¼s Î·s : ModeHom P m n) -> Set where
    id : âˆ€{m n} -> {Î¼s : ModeHom P m n} -> ModeTrans Î¼s Î¼s
    _â¨¾_ : âˆ€{m n k} -> {Î±â‚€ Î±â‚ : ModeHom P m n} -> {Î²â‚€ Î²â‚ : ModeHom P n k}
          -> ModeTrans Î±â‚€ Î±â‚
          -> ModeTrans Î²â‚€ Î²â‚
          -> ModeTrans (Î±â‚€ â—† Î²â‚€) (Î±â‚ â—† Î²â‚)



